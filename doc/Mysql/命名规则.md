 ##数据库命名


### 数据库环境
- dev：开发环境，开发可读写，可修改表结构。开发人员可以修改表结构，可以随意修改其中的数据但是需要保证不影响其他开发同事。
- qa：测试环境，开发可读写，开发人员可以通过工具修改表结构。
- sim：模拟环境，开发可读写，发起上线请求时，会先在这个环境上进行预执行，这个环境也可供部署上线演练或压力测试使用。
- real：生产数据库从库（准实时同步），只读环境，不允许修改数据，不允许修改表结构，供线上问题查找，数据查询等使用。
- online：线上环境，开发人员不允许直接在线上环境进行数据库操作，如果需要操作必须找DBA进行操作并进行相应记录，禁止进行压力测试。

    这些环境的机器，一定要做到权限划分明确，读写帐号分离，并且有辨识度，能区分具体业务。例如用户名w_account，r_ account 分别代表读、写账号，account是读写账号。

### 命名规范

#### 基本命名原则
- 使用有意义的英文词汇，词汇中间以下划线分隔。（不要用拼音）
- 只能使用英文字母，数字，下划线，并以英文字母开头。
- 库、表、字段全部采用小写，不要使用驼峰式命名。
- 避免用ORACLE、MySQL的保留字，如desc，关键字如index。
- 命名禁止超过32个字符，须见名之意，建议使用名词不是动词
- 数据库，数据表一律使用前缀
    - 临时库、表名必须以tmp为前缀，并以日期为后缀
    - 备份库、表必须以bak为前缀，并以日期为后缀
- 驼峰式的命名如何解决？需要在MySQL的配置文件my.ini中增加 lower_case_table_names = 1即可。

#### 表命名
- 同一个模块的表尽可能使用相同的前缀，表名称尽可能表达含义。所有日志表均以 log_ 开头

#### 字段命名
- 表达其实际含义的英文单词或简写。布尔意义的字段以“is_”作为前缀，后接动词过去分词。
- 各表之间相同意义的字段应同名。各表之间相同意义的字段，以去掉模块前缀的表名_字段名命名。
- 外键字段用表名_字段名表示其关联关系。
- 表的主键一般都约定成为id，自增类型，是别的表的外键均使用xxx_id的方式来表明。

#### 索引命名
- 非唯一索引必须按照“idx_字段名称_字段名称[_字段名]”进行命名
- 唯一索引必须按照“uniq_字段名称_字段名称[_字段名]”进行命名

#### 约束命名
- 主键约束：pk_表名称.
- 唯一约束：uk_表名称_字段名.(应用中需要同时有唯一性检查逻辑)

#### 触发器命名
- trg_表名_操作.

#### 序列命名
- seq_表名.

#### 表设计原则
- 表引擎取决于实际应用场景；日志及报表类表建议用myisam，与交易，审核，金额相关的表建议用innodb引擎。如无说明，建表时一律采用innodb引擎.
- 默认使用utf8mb4字符集，数据库排序规则使用utf8mb4_general_ci(utf8字符集无法保存Emoji表情,全面支持客户端输入的Emoji表情，升级编码为utf8mb4是最佳解决方案)
- 所有表、字段均应用 comment 列属性来描述此表、字段所代表的真正含义
- 如无说明，表中的第一个id字段一定是主键且为自动增长，禁止在非事务内作为上下文作为条件进行数据传递。禁止使用varchar类型作为主键语句设计
- 如无说明，表必须包含create_time和modify_time字段，即表必须包含记录创建时间和修改时间的字段
- 如无说明，表必须包含is_del，用来标示数据是否被删除，原则上数据库数据不允许物理删除。
- 用尽量少的存储空间来存数一个字段的数据
    - 能用int的就不用char或者varchar
    - 能用tinyint的就不用int
    - 使用UNSIGNED存储非负数值。
    - 不建议使用ENUM、SET类型，使用TINYINT来代替
    - 使用短数据类型，比如取值范围为0-80时，使用TINYINT UNSIGNED
    - 存储精确浮点数必须使用DECIMAL替代FLOAT和DOUBLE
    - 时间字段，除特殊情况一律采用int来记录unix_timestamp
        - 存储年使用YEAR类型。
        - 存储日期使用DATE类型。
        - 存储时间（精确到秒）建议使用TIMESTAMP类型，因为TIMESTAMP使用4字节，DATETIME使用8个字节。
    - 建议使用INT UNSIGNED存储IPV4。
    - 尽可能不使用TEXT、BLOB类型
    - 禁止在数据库中使用VARBINARY、BLOB存储图片、文件等。建议使用其他方式存储（TFS/SFS），MySQL只保存指针信息。
    - 单条记录大小禁止超过8k(列长度(中文)*3(UTF8)+列长度(英文)*1)

#### 对于mysql查询不区分大小写的情况
- 1.字段命名加BINARY 2.查询添加BINARY
    - 原理:对于CHAR、VARCHAR和TEXT类型，BINARY属性可以为列分配该列字符集的 校对规则.